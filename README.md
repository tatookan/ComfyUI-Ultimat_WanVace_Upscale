# Super Ultimate VACE Tools for ComfyUI

您的全能工具箱，专为在ComfyUI中使用VACE模型进行高级视频放大和生成而设计。解锁高分辨率视频增强和无缝长视频创作的能力。

![Demo Video](https://github.com/user-attachments/assets/ba9f91a1-b097-4ff2-9780-db85d014c978)

---

## ✨ 核心功能

- **🚀 AI视频放大**: 通过智能的空间和时间分块技术放大视频，有效避免接缝和伪影。
- **🎥 长视频生成**: 通过串联提示词和控制图像，创造出无缝衔接的长视频。
- **🧠 WAN 2.2 MoE 支持**: 自动兼容最新的混合专家（MoE）模型，实现顶尖的生成效果。
- **🔧 精准控制**: 利用负向注意力引导（NAG）、参考图和ControlNet对您的创作进行微调。

---

## 🛠️ 核心节点详解

### 节点: `SuperUltimateVaceUpscale`

这是插件的**核心放大节点**。它将低分辨率视频作为输入，输出高质量的放大版本。

#### 工作原理

- **空间分块 (Spatial Tiling)**:
  为防止显存耗尽，节点会将视频帧分割成多个重叠的小块。每一块都经过AI独立放大，然后通过平滑的羽化效果无缝地拼接回一张完整的高清帧。
  > **高级技巧**: 使用 `CustomCropArea` 节点可以应用为宽屏或竖屏视频优化的特殊分割方案。

- **时间分块 (Temporal Tiling)**:
  对于长视频，节点会将其切分成多个时间片段。每个片段独立处理，并通过**交叉淡入淡出**技术平滑地连接，确保视频在时间上的连贯性。

---

### 节点: `SuperUltimateVaceLongVideo`

这是用于**生成长视频**的节点。它通过将多个独立的生成片段拼接在一起，创造出连贯的长视频。

#### 工作原理

- **多轮生成**:
  您可以使用多个 `VACEPromptCombine` 节点来定义不同场景的提示词。此节点会按顺序处理它们，并使用上一片段的结尾几帧作为下一片段的开头，从而实现无缝过渡。

- **质量保持**:
  长视频生成面临的一个挑战是质量逐代下降。此节点通过内置的**过渡帧修复**机制，有效缓解了色彩失真和模糊等问题。
  > **高级技巧**: 使用 `CustomRefineOption` 节点可以进一步微调过渡效果。

---

## 🧠 高级功能

### 负向注意力引导 (NAG)

- **作用**: 类似于负向提示词，NAG通过告诉模型**不要**生成什么来提升最终质量。
- **使用**: 连接 `NAGParamtersSetting` 节点来启用和配置NAG。

### 混合专家模型 (MoE) for WAN 2.2

- **自动检测**: 插件会自动识别您加载的是否为WAN 2.2 MoE模型，并启用专用采样流程。
- **双阶段采样**: 针对MoE架构，采样分为**高噪声粗处理**和**低噪声精修**两个阶段，以达到最佳效果。
- **使用**: 对于高级用户，可以连接 `MOEParamtersSetting` 节点来调整专家网络参数。

---

## 🧩 辅助节点

| 节点名称 | 功能简介 |
| --------------------------- | ---------------------------------------------------------------- |
| `CustomCropArea` | 提供为宽屏或竖屏视频优化的特殊分块方案。 |
| `VACEPromptCombine` | 将多个提示词片段串联起来，用于长视频生成。 |
| `VACEControlImageCombine` | 组合多个控制图像（如深度图、姿态图）以实现复杂控制。 |
| `CustomRefineOption` | 微调长视频片段之间的过渡效果，提升平滑度。 |
| `NAGParamtersSetting` | 配置NAG（负向注意力引导）参数。 |
| `MOEParamtersSetting` | (WAN 2.2) 配置MoE（混合专家）参数。 |

---

## 🚀 安装指南

1.  **Git Clone (推荐)**:
    在 `ComfyUI\custom_nodes` 目录下打开终端，运行以下命令：
    ```bash
    git clone https://github.com/tatookan/ComfyUI-Ultimat_WanVace_Upscale.git
    ```

2.  **手动下载**:
    - 下载本项目的ZIP压缩包。
    - 将其解压到 `ComfyUI\custom_nodes` 目录下。

**安装完成后，请重启ComfyUI。**

---


---

## 📞 联系方式


- **Email**: 370638508@qq.com

